{"version":3,"file":"index-DhPHNa3A.js","sources":["../../src/pages/plans/edit/PlansEditPage.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\n\nimport { useNavigate, useParams } from 'react-router-dom'\n\nimport { Box, CircularProgress, Alert } from '@mui/material'\n\nimport { getTrainingPlan, updateTrainingPlan } from '@/api/trainingPlans'\nimport { routes } from '@/routes'\nimport type { TrainingPlan } from '@/types/database'\n\nimport { PlanForm, planToFormData, formDataToPlanUpdate, type PlanFormData } from '../components'\n\nexport function PlansEditPage() {\n  const { id } = useParams<{ id: string }>()\n  const navigate = useNavigate()\n  const [plan, setPlan] = useState<TrainingPlan | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [submitting, setSubmitting] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    if (id) {\n      loadPlan(Number(id))\n    }\n  }, [id])\n\n  async function loadPlan(planId: number) {\n    try {\n      setLoading(true)\n      const data = await getTrainingPlan(planId)\n      setPlan(data)\n    } catch (err) {\n      setError('훈련 계획을 불러오는데 실패했습니다.')\n      // eslint-disable-next-line no-console\n      console.error(err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  async function handleSubmit(data: PlanFormData) {\n    if (!plan) return\n\n    if (!data.name.trim()) {\n      setError('계획 이름을 입력해주세요.')\n      return\n    }\n    if (!data.unitName.trim()) {\n      setError('훈련 단위를 입력해주세요.')\n      return\n    }\n    if (data.scheduleType === 'weekly' && data.scheduleDays.length === 0) {\n      setError('훈련 요일을 선택해주세요.')\n      return\n    }\n\n    try {\n      setSubmitting(true)\n      setError(null)\n      await updateTrainingPlan(plan.id, formDataToPlanUpdate(data))\n      navigate(routes.plans.detail.$path({ id: plan.id }, {}))\n    } catch (err) {\n      setError('계획 수정에 실패했습니다.')\n      // eslint-disable-next-line no-console\n      console.error(err)\n    } finally {\n      setSubmitting(false)\n    }\n  }\n\n  function handleCancel() {\n    if (plan) {\n      navigate(routes.plans.detail.$path({ id: plan.id }, {}))\n    } else {\n      navigate(routes.plans.$())\n    }\n  }\n\n  if (loading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\n        <CircularProgress />\n      </Box>\n    )\n  }\n\n  if (!plan) {\n    return <Alert severity=\"warning\">훈련 계획을 찾을 수 없습니다.</Alert>\n  }\n\n  return (\n    <PlanForm\n      initialData={planToFormData(plan)}\n      onSubmit={handleSubmit}\n      onCancel={handleCancel}\n      loading={submitting}\n      error={error}\n      title=\"훈련 계획 수정\"\n      submitLabel=\"저장\"\n      loadingLabel=\"저장 중...\"\n    />\n  )\n}\n"],"names":["useState","useEffect","jsx"],"mappings":";;;;;;;;;;;;;;;;AAYO,SAAS,gBAAgB;AAC9B,QAAM,EAAE,GAAA,IAAO,UAAA;AACf,QAAM,WAAW,YAAA;AACjB,QAAM,CAAC,MAAM,OAAO,IAAIA,aAAAA,SAA8B,IAAI;AAC1D,QAAM,CAAC,SAAS,UAAU,IAAIA,aAAAA,SAAS,IAAI;AAC3C,QAAM,CAAC,YAAY,aAAa,IAAIA,aAAAA,SAAS,KAAK;AAClD,QAAM,CAAC,OAAO,QAAQ,IAAIA,aAAAA,SAAwB,IAAI;AAEtDC,eAAAA,UAAU,MAAM;AACd,QAAI,IAAI;AACN,eAAS,OAAO,EAAE,CAAC;AAAA,IACrB;AAAA,EACF,GAAG,CAAC,EAAE,CAAC;AAEP,iBAAe,SAAS,QAAgB;AACtC,QAAI;AACF,iBAAW,IAAI;AACf,YAAM,OAAO,MAAM,gBAAgB,MAAM;AACzC,cAAQ,IAAI;AAAA,IACd,SAAS,KAAK;AACZ,eAAS,sBAAsB;AAE/B,cAAQ,MAAM,GAAG;AAAA,IACnB,UAAA;AACE,iBAAW,KAAK;AAAA,IAClB;AAAA,EACF;AAEA,iBAAe,aAAa,MAAoB;AAC9C,QAAI,CAAC,KAAM;AAEX,QAAI,CAAC,KAAK,KAAK,QAAQ;AACrB,eAAS,gBAAgB;AACzB;AAAA,IACF;AACA,QAAI,CAAC,KAAK,SAAS,QAAQ;AACzB,eAAS,gBAAgB;AACzB;AAAA,IACF;AACA,QAAI,KAAK,iBAAiB,YAAY,KAAK,aAAa,WAAW,GAAG;AACpE,eAAS,gBAAgB;AACzB;AAAA,IACF;AAEA,QAAI;AACF,oBAAc,IAAI;AAClB,eAAS,IAAI;AACb,YAAM,mBAAmB,KAAK,IAAI,qBAAqB,IAAI,CAAC;AAC5D,eAAS,OAAO,MAAM,OAAO,MAAM,EAAE,IAAI,KAAK,MAAM,CAAA,CAAE,CAAC;AAAA,IACzD,SAAS,KAAK;AACZ,eAAS,gBAAgB;AAEzB,cAAQ,MAAM,GAAG;AAAA,IACnB,UAAA;AACE,oBAAc,KAAK;AAAA,IACrB;AAAA,EACF;AAEA,WAAS,eAAe;AACtB,QAAI,MAAM;AACR,eAAS,OAAO,MAAM,OAAO,MAAM,EAAE,IAAI,KAAK,MAAM,CAAA,CAAE,CAAC;AAAA,IACzD,OAAO;AACL,eAAS,OAAO,MAAM,GAAG;AAAA,IAC3B;AAAA,EACF;AAEA,MAAI,SAAS;AACX,WACEC,kCAAAA,IAAC,KAAA,EAAI,IAAI,EAAE,SAAS,QAAQ,gBAAgB,UAAU,IAAI,EAAA,GACxD,UAAAA,kCAAAA,IAAC,oBAAiB,GACpB;AAAA,EAEJ;AAEA,MAAI,CAAC,MAAM;AACT,WAAOA,kCAAAA,IAAC,OAAA,EAAM,UAAS,WAAU,UAAA,qBAAiB;AAAA,EACpD;AAEA,SACEA,kCAAAA;AAAAA,IAAC;AAAA,IAAA;AAAA,MACC,aAAa,eAAe,IAAI;AAAA,MAChC,UAAU;AAAA,MACV,UAAU;AAAA,MACV,SAAS;AAAA,MACT;AAAA,MACA,OAAM;AAAA,MACN,aAAY;AAAA,MACZ,cAAa;AAAA,IAAA;AAAA,EAAA;AAGnB;"}