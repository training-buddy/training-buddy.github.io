{"version":3,"file":"schedule-DhBQ9WQn.js","sources":["../../src/utils/schedule.ts"],"sourcesContent":["import type { TrainingPlan, WeekDay } from '../types/database'\n\nconst WEEKDAY_MAP: Record<WeekDay, number> = {\n  sun: 0,\n  mon: 1,\n  tue: 2,\n  wed: 3,\n  thu: 4,\n  fri: 5,\n  sat: 6,\n}\n\nexport function calculateTotalSessions(plan: TrainingPlan): number {\n  return Math.ceil(plan.total_amount / plan.unit_amount)\n}\n\nexport function calculateEndDate(plan: TrainingPlan): Date {\n  const totalSessions = calculateTotalSessions(plan)\n  const startDate = new Date(plan.start_date)\n\n  if (plan.schedule_type === 'daily') {\n    const endDate = new Date(startDate)\n    endDate.setDate(endDate.getDate() + totalSessions - 1)\n    return endDate\n  }\n\n  // weekly schedule\n  const scheduleDays = plan.schedule_days ?? []\n  if (scheduleDays.length === 0) {\n    return startDate\n  }\n\n  const dayNumbers = scheduleDays.map((d) => WEEKDAY_MAP[d]).sort((a, b) => a - b)\n  const currentDate = new Date(startDate)\n  let sessionsScheduled = 0\n\n  while (sessionsScheduled < totalSessions) {\n    const currentDay = currentDate.getDay()\n    if (dayNumbers.includes(currentDay)) {\n      sessionsScheduled++\n      if (sessionsScheduled >= totalSessions) {\n        break\n      }\n    }\n    currentDate.setDate(currentDate.getDate() + 1)\n  }\n\n  return currentDate\n}\n\nexport function formatDate(date: Date): string {\n  return date.toLocaleDateString('ko-KR', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n  })\n}\n\nexport function getWeekDayLabel(day: WeekDay): string {\n  const labels: Record<WeekDay, string> = {\n    mon: '월',\n    tue: '화',\n    wed: '수',\n    thu: '목',\n    fri: '금',\n    sat: '토',\n    sun: '일',\n  }\n  return labels[day]\n}\n\nexport const ALL_WEEKDAYS: WeekDay[] = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun']\n\nconst NUMBER_TO_WEEKDAY: WeekDay[] = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat']\n\nexport function isScheduledForDate(plan: TrainingPlan, date: Date): boolean {\n  const startDate = new Date(plan.start_date)\n  startDate.setHours(0, 0, 0, 0)\n\n  const checkDate = new Date(date)\n  checkDate.setHours(0, 0, 0, 0)\n\n  // Check if date is before start date\n  if (checkDate < startDate) {\n    return false\n  }\n\n  // Check if date is after end date\n  const endDate = calculateEndDate(plan)\n  endDate.setHours(23, 59, 59, 999)\n  if (checkDate > endDate) {\n    return false\n  }\n\n  if (plan.schedule_type === 'daily') {\n    return true\n  }\n\n  // weekly schedule - check if the day matches\n  const scheduleDays = plan.schedule_days ?? []\n  const dayOfWeek = NUMBER_TO_WEEKDAY[checkDate.getDay()]\n  return scheduleDays.includes(dayOfWeek)\n}\n\nexport function getTodaysPlans(plans: TrainingPlan[]): TrainingPlan[] {\n  const today = new Date()\n  return plans.filter((plan) => isScheduledForDate(plan, today))\n}\n"],"names":[],"mappings":"AAEA,MAAM,cAAuC;AAAA,EAC3C,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AACP;AAEO,SAAS,uBAAuB,MAA4B;AACjE,SAAO,KAAK,KAAK,KAAK,eAAe,KAAK,WAAW;AACvD;AAEO,SAAS,iBAAiB,MAA0B;AACzD,QAAM,gBAAgB,uBAAuB,IAAI;AACjD,QAAM,YAAY,IAAI,KAAK,KAAK,UAAU;AAE1C,MAAI,KAAK,kBAAkB,SAAS;AAClC,UAAM,UAAU,IAAI,KAAK,SAAS;AAClC,YAAQ,QAAQ,QAAQ,QAAA,IAAY,gBAAgB,CAAC;AACrD,WAAO;AAAA,EACT;AAGA,QAAM,eAAe,KAAK,iBAAiB,CAAA;AAC3C,MAAI,aAAa,WAAW,GAAG;AAC7B,WAAO;AAAA,EACT;AAEA,QAAM,aAAa,aAAa,IAAI,CAAC,MAAM,YAAY,CAAC,CAAC,EAAE,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAC/E,QAAM,cAAc,IAAI,KAAK,SAAS;AACtC,MAAI,oBAAoB;AAExB,SAAO,oBAAoB,eAAe;AACxC,UAAM,aAAa,YAAY,OAAA;AAC/B,QAAI,WAAW,SAAS,UAAU,GAAG;AACnC;AACA,UAAI,qBAAqB,eAAe;AACtC;AAAA,MACF;AAAA,IACF;AACA,gBAAY,QAAQ,YAAY,QAAA,IAAY,CAAC;AAAA,EAC/C;AAEA,SAAO;AACT;AAEO,SAAS,WAAW,MAAoB;AAC7C,SAAO,KAAK,mBAAmB,SAAS;AAAA,IACtC,MAAM;AAAA,IACN,OAAO;AAAA,IACP,KAAK;AAAA,EAAA,CACN;AACH;AAEO,SAAS,gBAAgB,KAAsB;AACpD,QAAM,SAAkC;AAAA,IACtC,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,EAAA;AAEP,SAAO,OAAO,GAAG;AACnB;AAEO,MAAM,eAA0B,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAK;AAEvF,MAAM,oBAA+B,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAK;AAE9E,SAAS,mBAAmB,MAAoB,MAAqB;AAC1E,QAAM,YAAY,IAAI,KAAK,KAAK,UAAU;AAC1C,YAAU,SAAS,GAAG,GAAG,GAAG,CAAC;AAE7B,QAAM,YAAY,IAAI,KAAK,IAAI;AAC/B,YAAU,SAAS,GAAG,GAAG,GAAG,CAAC;AAG7B,MAAI,YAAY,WAAW;AACzB,WAAO;AAAA,EACT;AAGA,QAAM,UAAU,iBAAiB,IAAI;AACrC,UAAQ,SAAS,IAAI,IAAI,IAAI,GAAG;AAChC,MAAI,YAAY,SAAS;AACvB,WAAO;AAAA,EACT;AAEA,MAAI,KAAK,kBAAkB,SAAS;AAClC,WAAO;AAAA,EACT;AAGA,QAAM,eAAe,KAAK,iBAAiB,CAAA;AAC3C,QAAM,YAAY,kBAAkB,UAAU,OAAA,CAAQ;AACtD,SAAO,aAAa,SAAS,SAAS;AACxC;AAEO,SAAS,eAAe,OAAuC;AACpE,QAAM,4BAAY,KAAA;AAClB,SAAO,MAAM,OAAO,CAAC,SAAS,mBAAmB,MAAM,KAAK,CAAC;AAC/D;"}